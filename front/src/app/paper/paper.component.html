<div class="sticky top-0 z-10 bg-white">
  <input
    type="file"
    #opener
    (change)="open($event)"
    style="display: none"
    accept=".json"
  />
  <button mat-button (click)="opener.click()">ğŸ“ æ‰“å¼€</button>
  <button mat-button (click)="save()">ğŸ’½ ä¿å­˜</button>
  <button mat-button (click)="reset()">ğŸ—‘ï¸ å¤åŸ</button>
  <button mat-button (click)="exportWord()">ğŸ’¾ å¯¼å‡ºWord</button>
  <button mat-flat-button color="accent" (click)="openEditParagraph(-1)">
    ğŸ“‹ æ·»åŠ æ®µè½
  </button>
</div>
<div>
  <div class="flex">
    <mat-form-field class="w-80">
      <mat-label>è®ºæ–‡é¢˜ç›®</mat-label>
      <input matInput [(ngModel)]="paper.title" />
    </mat-form-field>
    <mat-form-field class="w-40">
      <mat-label>å­¦é™¢</mat-label>
      <input matInput [(ngModel)]="paper.college" />
    </mat-form-field>
    <mat-form-field class="w-44">
      <mat-label>ä¸“ä¸š</mat-label>
      <input matInput [(ngModel)]="paper.major" />
    </mat-form-field>
    <mat-form-field class="w-36">
      <mat-label>å­¦å·</mat-label>
      <input matInput [(ngModel)]="paper.studentId" />
    </mat-form-field>
    <mat-form-field class="w-20">
      <mat-label>å­¦ç”Ÿå§“å</mat-label>
      <input matInput [(ngModel)]="paper.studentName" />
    </mat-form-field>
    <mat-form-field class="w-20">
      <mat-label>æ•™å¸ˆå§“å</mat-label>
      <input matInput [(ngModel)]="paper.teacherName" />
    </mat-form-field>
  </div>
  <div class="flex">
    <mat-form-field>
      <mat-label>ä¸­æ–‡å…³é”®è¯</mat-label>
      <input matInput [(ngModel)]="paper.keywordCn" />
    </mat-form-field>
    <mat-form-field>
      <mat-label>è‹±æ–‡å…³é”®è¯</mat-label>
      <input matInput [(ngModel)]="paper.keywordEn" />
    </mat-form-field>
    <div class="block">
      <span class="text-sm">å­¦ç”Ÿç­¾å</span>
      <img
        class="cursor-pointer max-h-10"
        [src]="paper.studentNameImage"
        (click)="fileInput.click()"
      />
      <input
        type="file"
        #fileInput
        (change)="onSelectStudentImage($event)"
        style="display: none"
      />
    </div>
    <div class="block">
      <span class="text-sm">æ•™å¸ˆç­¾å</span>
      <img
        class="cursor-pointer max-h-10"
        [src]="paper.teacherNameImage"
        (click)="fileInput2.click()"
      />
      <input
        type="file"
        #fileInput2
        (change)="onSelectTeacherImage($event)"
        style="display: none"
      />
    </div>
  </div>
  <div class="flex">
    <mat-form-field class="w-1/5">
      <mat-label>ä¸­æ–‡æ‘˜è¦</mat-label>
      <textarea
        cdkTextareaAutosize
        cdkAutosizeMinRows="1"
        cdkAutosizeMaxRows="20"
        matInput
        [(ngModel)]="paper.abstractCn"
      ></textarea>
    </mat-form-field>
    <mat-form-field class="w-1/5">
      <mat-label>è‹±æ–‡æ‘˜è¦</mat-label>
      <textarea
        matInput
        cdkTextareaAutosize
        cdkAutosizeMinRows="1"
        cdkAutosizeMaxRows="20"
        [(ngModel)]="paper.abstractEn"
      ></textarea>
    </mat-form-field>
    <mat-form-field class="w-1/5">
      <mat-label>ç»“è®º</mat-label>
      <textarea
        cdkTextareaAutosize
        cdkAutosizeMinRows="1"
        cdkAutosizeMaxRows="20"
        matInput
        [(ngModel)]="paper.result"
      ></textarea>
    </mat-form-field>
    <mat-form-field class="w-1/5">
      <mat-label>è‡´è°¢</mat-label>
      <textarea
        matInput
        cdkTextareaAutosize
        cdkAutosizeMinRows="1"
        cdkAutosizeMaxRows="20"
        [(ngModel)]="paper.thank"
      ></textarea>
    </mat-form-field>
    <mat-form-field class="w-1/5">
      <mat-label>ç»ªè®º</mat-label>
      <textarea
        matInput
        cdkTextareaAutosize
        cdkAutosizeMinRows="1"
        cdkAutosizeMaxRows="20"
        [(ngModel)]="paper.intro"
      ></textarea>
    </mat-form-field>
  </div>
  <button mat-flat-button color="primary" (click)="openCiteDialog()">
    æ·»åŠ å‚è€ƒæ–‡çŒ®
  </button>
  @for (cite of paper.cites; track $index) {
  <div class="block">
    <span
      >[{{ $index + 1 }}]{{ cite.title }}.{{ cite.author }}.{{
        cite.year
      }}....</span
    ><button mat-flat-button color="primary" (click)="editCite($index)">
      ç¼–è¾‘
    </button>
    <button
      mat-flat-button
      color="accent"
      (click)="paper.cites.splice($index, 1)"
    >
      åˆ é™¤
    </button>
  </div>
  }
</div>
<div class="m-3" cdkDropList (cdkDropListDropped)="drop($event)">
  @for (parag of paper.paragraphs; track $index) {
  <bl-paragraph-display
    cdkDrag
    [para]="parag"
    [index]="$index"
    (onEdit)="openEditParagraph($event)"
    (onDelete)="deleteParagraph($event)"
  ></bl-paragraph-display>
  }
</div>
