<div class="block">
  <p class="text-3xl m-5">制作测试用例表</p>
</div>
<p class="m-3">模仿下面的例子，即可快速制作测试用例信息的Word文档。</p>
<div class="flex m-3">
  <textarea
    (keyup)="doParse()"
    class="outline-double whitespace-pre overflow-x-auto"
    [rows]="30"
    [cols]="80"
    [(ngModel)]="dsl"
  ></textarea>
  <div class="ml-6">
    <p>系统名称：{{ pj.name }}</p>
    @for (mod of pj.tests; track $index) {
    <div class="m-6">
      <p class="font-extrabold">{{ mod.name }}模块</p>
      @for (func of mod.funcs; track $index) {
      <p>{{ func.name }}功能</p>
      <table>
        <th>测试操作</th>
        <th>预置条件</th>
        <th>测试描述</th>
        <th>数据</th>
        <th>期望结果</th>
        @for (case of func.testCases; track $index) {
        <tr>
          <td>{{ $index + 1 }}</td>
          <td>{{ case.condition }}</td>
          <td>{{ case.intro }}</td>
          <td>{{ case.data }}</td>
          <td>{{ case.result }}</td>
        </tr>
        }
      </table>
      }
    </div>
    }

    <button mat-flat-button color="primary" (click)="exportWord()">
      导出word
    </button>
    <button mat-flat-button color="warn" (click)="reset()">还原</button>
  </div>
</div>
